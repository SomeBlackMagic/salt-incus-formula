cases:
  # ============================================================
  # CASE 1: profile_001 - Minimal profile
  # ============================================================
  - name: profile_001
    pillars:
      incus:
        profiles:
          test-profile-1:
            ensure: present
            description: Test profile 1
            config:
              limits.cpu: '1'
              limits.memory: 512MB
              security.nesting: 'false'
              security.privileged: 'false'
              boot.autostart: 'false'
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-1"
        - "changes"
      local_shell:
        - cmd: incus profile show test-profile-1
          expect_stdout:
            - "limits.cpu: \"1\""
            - "limits.memory: 512MB"
    cleanup:
      - incus profile delete test-profile-1

  # ============================================================
  # CASE 2: profile_002 - All security enabled
  # ============================================================
  - name: profile_002
    pillars:
      incus:
        profiles:
          test-profile-2:
            ensure: present
            description: Test profile 2
            config:
              limits.cpu: '2'
              limits.memory: 1GB
              security.nesting: 'true'
              security.privileged: 'true'
              boot.autostart: 'true'
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-2"
        - "changes"
      local_shell:
        - cmd: incus profile show test-profile-2
          expect_stdout:
            - "security.nesting: \"true\""
            - "security.privileged: \"true\""
    cleanup:
      - incus profile delete test-profile-2

  # ============================================================
  # CASE 3: profile_003 - With network device
  # ============================================================
  - name: profile_003
    pillars:
      incus:
        profiles:
          test-profile-3:
            ensure: present
            description: Test profile 3
            config:
              limits.cpu: '4'
              limits.memory: 2GB
              security.nesting: 'true'
              security.privileged: 'false'
              boot.autostart: 'true'
            devices:
              eth0:
                name: eth0
                type: nic
                nictype: bridged
                parent: lxdbr0
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-3"
        - "changes"
      local_shell:
        - cmd: incus profile show test-profile-3
          expect_stdout:
            - "type: nic"
            - "parent: lxdbr0"
    cleanup:
      - incus profile delete test-profile-3

  # ============================================================
  # CASE 4: profile_004 - High CPU with network device
  # ============================================================
  - name: profile_004
    pillars:
      incus:
        profiles:
          test-profile-4:
            ensure: present
            description: Test profile 4
            config:
              limits.cpu: '8'
              limits.memory: 4GB
              security.nesting: 'false'
              security.privileged: 'true'
              boot.autostart: 'false'
            devices:
              eth0:
                name: eth0
                type: nic
                nictype: bridged
                parent: lxdbr0
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-4"
        - "changes"
    cleanup:
      - incus profile delete test-profile-4

  # ============================================================
  # CASE 5: profile_005 - High resources with disk device
  # ============================================================
  - name: profile_005
    pillars:
      incus:
        profiles:
          test-profile-5:
            ensure: present
            description: Test profile 5
            config:
              limits.cpu: '8'
              limits.memory: 8GB
              security.nesting: 'true'
              security.privileged: 'false'
              boot.autostart: 'false'
            devices:
              root:
                path: /
                pool: default
                type: disk
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-5"
        - "changes"
      local_shell:
        - cmd: incus profile show test-profile-5
          expect_stdout:
            - "type: disk"
            - "pool: default"
    cleanup:
      - incus profile delete test-profile-5

  # ============================================================
  # CASE 6: profile_006 - Full devices configuration
  # ============================================================
  - name: profile_006
    pillars:
      incus:
        profiles:
          test-profile-6:
            ensure: present
            description: Test profile 6
            config:
              limits.cpu: '4'
              limits.memory: 8GB
              security.nesting: 'false'
              security.privileged: 'true'
              boot.autostart: 'true'
            devices:
              eth0:
                name: eth0
                type: nic
                nictype: bridged
                parent: lxdbr0
              root:
                path: /
                pool: default
                type: disk
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-6"
        - "changes"
    cleanup:
      - incus profile delete test-profile-6

  # ============================================================
  # CASE 7: profile_007 - Low memory with disk
  # ============================================================
  - name: profile_007
    pillars:
      incus:
        profiles:
          test-profile-7:
            ensure: present
            description: Test profile 7
            config:
              limits.cpu: '2'
              limits.memory: 512MB
              security.nesting: 'false'
              security.privileged: 'true'
              boot.autostart: 'true'
            devices:
              root:
                path: /
                pool: default
                type: disk
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-7"
        - "changes"
    cleanup:
      - incus profile delete test-profile-7

  # ============================================================
  # CASE 8: profile_008 - Full config with all devices
  # ============================================================
  - name: profile_008
    pillars:
      incus:
        profiles:
          test-profile-8:
            ensure: present
            description: Test profile 8
            config:
              limits.cpu: '1'
              limits.memory: 4GB
              security.nesting: 'true'
              security.privileged: 'false'
              boot.autostart: 'true'
            devices:
              eth0:
                name: eth0
                type: nic
                nictype: bridged
                parent: lxdbr0
              root:
                path: /
                pool: default
                type: disk
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-8"
        - "changes"
    cleanup:
      - incus profile delete test-profile-8

  # ============================================================
  # CASE 9: profile_009 - Medium with all devices
  # ============================================================
  - name: profile_009
    pillars:
      incus:
        profiles:
          test-profile-9:
            ensure: present
            description: Test profile 9
            config:
              limits.cpu: '2'
              limits.memory: 2GB
              security.nesting: 'false'
              security.privileged: 'false'
              boot.autostart: 'false'
            devices:
              eth0:
                name: eth0
                type: nic
                nictype: bridged
                parent: lxdbr0
              root:
                path: /
                pool: default
                type: disk
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-9"
        - "changes"
    cleanup:
      - incus profile delete test-profile-9

  # ============================================================
  # CASE 10: profile_010 - Minimal with disk
  # ============================================================
  - name: profile_010
    pillars:
      incus:
        profiles:
          test-profile-10:
            ensure: present
            description: Test profile 10
            config:
              limits.cpu: '1'
              limits.memory: 1GB
              security.nesting: 'false'
              security.privileged: 'false'
              boot.autostart: 'false'
            devices:
              root:
                path: /
                pool: default
                type: disk
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-10"
        - "changes"
    cleanup:
      - incus profile delete test-profile-10

  # ============================================================
  # CASE 11: profile_011 - High CPU low memory with disk
  # ============================================================
  - name: profile_011
    pillars:
      incus:
        profiles:
          test-profile-11:
            ensure: present
            description: Test profile 11
            config:
              limits.cpu: '4'
              limits.memory: 512MB
              security.nesting: 'true'
              security.privileged: 'false'
              boot.autostart: 'false'
            devices:
              root:
                path: /
                pool: default
                type: disk
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-11"
        - "changes"
    cleanup:
      - incus profile delete test-profile-11

  # ============================================================
  # CASE 12: profile_012 - High resources privileged
  # ============================================================
  - name: profile_012
    pillars:
      incus:
        profiles:
          test-profile-12:
            ensure: present
            description: Test profile 12
            config:
              limits.cpu: '8'
              limits.memory: 2GB
              security.nesting: 'false'
              security.privileged: 'true'
              boot.autostart: 'true'
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-12"
        - "changes"
    cleanup:
      - incus profile delete test-profile-12

  # ============================================================
  # CASE 13: profile_013 - Minimal CPU high memory with network
  # ============================================================
  - name: profile_013
    pillars:
      incus:
        profiles:
          test-profile-13:
            ensure: present
            description: Test profile 13
            config:
              limits.cpu: '1'
              limits.memory: 8GB
              security.nesting: 'false'
              security.privileged: 'true'
              boot.autostart: 'true'
            devices:
              eth0:
                name: eth0
                type: nic
                nictype: bridged
                parent: lxdbr0
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-13"
        - "changes"
    cleanup:
      - incus profile delete test-profile-13

  # ============================================================
  # CASE 14: profile_014 - High CPU low memory all devices
  # ============================================================
  - name: profile_014
    pillars:
      incus:
        profiles:
          test-profile-14:
            ensure: present
            description: Test profile 14
            config:
              limits.cpu: '8'
              limits.memory: 512MB
              security.nesting: 'false'
              security.privileged: 'false'
              boot.autostart: 'true'
            devices:
              eth0:
                name: eth0
                type: nic
                nictype: bridged
                parent: lxdbr0
              root:
                path: /
                pool: default
                type: disk
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-14"
        - "changes"
    cleanup:
      - incus profile delete test-profile-14

  # ============================================================
  # CASE 15: profile_015 - Medium resources all devices
  # ============================================================
  - name: profile_015
    pillars:
      incus:
        profiles:
          test-profile-15:
            ensure: present
            description: Test profile 15
            config:
              limits.cpu: '4'
              limits.memory: 1GB
              security.nesting: 'false'
              security.privileged: 'false'
              boot.autostart: 'true'
            devices:
              eth0:
                name: eth0
                type: nic
                nictype: bridged
                parent: lxdbr0
              root:
                path: /
                pool: default
                type: disk
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-15"
        - "changes"
    cleanup:
      - incus profile delete test-profile-15

  # ============================================================
  # CASE 16: profile_016 - Low CPU medium memory with disk
  # ============================================================
  - name: profile_016
    pillars:
      incus:
        profiles:
          test-profile-16:
            ensure: present
            description: Test profile 16
            config:
              limits.cpu: '2'
              limits.memory: 4GB
              security.nesting: 'false'
              security.privileged: 'false'
              boot.autostart: 'true'
            devices:
              root:
                path: /
                pool: default
                type: disk
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-16"
        - "changes"
    cleanup:
      - incus profile delete test-profile-16

  # ============================================================
  # CASE 17: profile_017 - Low CPU high memory with network
  # ============================================================
  - name: profile_017
    pillars:
      incus:
        profiles:
          test-profile-17:
            ensure: present
            description: Test profile 17
            config:
              limits.cpu: '2'
              limits.memory: 8GB
              security.nesting: 'false'
              security.privileged: 'false'
              boot.autostart: 'true'
            devices:
              eth0:
                name: eth0
                type: nic
                nictype: bridged
                parent: lxdbr0
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-17"
        - "changes"
    cleanup:
      - incus profile delete test-profile-17

  # ============================================================
  # CASE 18: profile_018 - Medium resources basic
  # ============================================================
  - name: profile_018
    pillars:
      incus:
        profiles:
          test-profile-18:
            ensure: present
            description: Test profile 18
            config:
              limits.cpu: '4'
              limits.memory: 4GB
              security.nesting: 'false'
              security.privileged: 'false'
              boot.autostart: 'true'
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-18"
        - "changes"
    cleanup:
      - incus profile delete test-profile-18

  # ============================================================
  # CASE 19: profile_019 - High CPU low memory with network
  # ============================================================
  - name: profile_019
    pillars:
      incus:
        profiles:
          test-profile-19:
            ensure: present
            description: Test profile 19
            config:
              limits.cpu: '8'
              limits.memory: 1GB
              security.nesting: 'false'
              security.privileged: 'false'
              boot.autostart: 'true'
            devices:
              eth0:
                name: eth0
                type: nic
                nictype: bridged
                parent: lxdbr0
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-19"
        - "changes"
    cleanup:
      - incus profile delete test-profile-19

  # ============================================================
  # CASE 20: profile_020 - Minimal CPU medium memory with disk
  # ============================================================
  - name: profile_020
    pillars:
      incus:
        profiles:
          test-profile-20:
            ensure: present
            description: Test profile 20
            config:
              limits.cpu: '1'
              limits.memory: 2GB
              security.nesting: 'false'
              security.privileged: 'false'
              boot.autostart: 'true'
            devices:
              root:
                path: /
                pool: default
                type: disk
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-20"
        - "changes"
    cleanup:
      - incus profile delete test-profile-20

  # ============================================================
  # CASE 21: profile_021 - Minimal CPU high memory basic
  # ============================================================
  - name: profile_021
    pillars:
      incus:
        profiles:
          test-profile-21:
            ensure: present
            description: Test profile 21
            config:
              limits.cpu: '1'
              limits.memory: 8GB
              security.nesting: 'false'
              security.privileged: 'false'
              boot.autostart: 'true'
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-21"
        - "changes"
    cleanup:
      - incus profile delete test-profile-21

  # ============================================================
  # CASE 22: profile_022 - Minimal resources with network
  # ============================================================
  - name: profile_022
    pillars:
      incus:
        profiles:
          test-profile-22:
            ensure: present
            description: Test profile 22
            config:
              limits.cpu: '1'
              limits.memory: 512MB
              security.nesting: 'false'
              security.privileged: 'false'
              boot.autostart: 'true'
            devices:
              eth0:
                name: eth0
                type: nic
                nictype: bridged
                parent: lxdbr0
    command: state.apply profiles
    expected:
      salt_output_contains:
        - "test-profile-22"
        - "changes"
    cleanup:
      - incus profile delete test-profile-22
