cases:
  # ============================================================
  # CASE 1: network_001 - Bridge network with IPv4
  # ============================================================
  - name: network_001
    pillars:
      incus:
        networks:
          net-bridge-1:
            network_type: bridge
            description: Test bridge network
            config:
              ipv4.address: 10.101.0.1/24
              ipv4.nat: 'true'
              ipv4.dhcp: 'true'
              ipv6.address: none
              dns.domain: test1.local
              dns.mode: managed
              bridge.driver: native
              bridge.mtu: '1500'
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-bridge-1"
        - "changes"
      local_shell:
        - cmd: incus network show net-bridge-1
          expect_stdout:
            - "ipv4.address: 10.101.0.1/24"
            - "bridge.driver: native"
    cleanup:
      - incus network delete net-bridge-1

  # ============================================================
  # CASE 2: network_002 - OVN network with IPv6
  # ============================================================
  - name: network_002
    pillars:
      incus:
        networks:
          net-ovn-2:
            network_type: ovn
            description: Test ovn network
            config:
              ipv4.address: none
              ipv6.address: fd42:0002::1/64
              #ipv6.nat: 'false'
              ipv6.dhcp: 'true'
              dns.domain: test2.local
              dns.mode: managed
              network: ovn-uplink
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-ovn-2"
        - "changes"
      local_shell:
        - cmd: incus network show net-ovn-2
          expect_stdout:
            - "ipv6.address: fd42:0002::1/64"
            - "network: ovn-uplink"
    cleanup:
      - incus network delete net-ovn-2

  # ============================================================
  # CASE 3: network_003 - Physical network dual stack
  # ============================================================
  - name: network_003
    pillars:
      incus:
        networks:
          net-physical-3:
            network_type: physical
            description: Test physical network
            config:
              ipv4.address: 10.103.0.1/24
              ipv4.nat: 'false'
              ipv4.dhcp: 'true'
              ipv6.address: fd42:0003::1/64
              #ipv6.nat: 'false'
              ipv6.dhcp: 'true'
              parent: eth0
              mtu: '1500'
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-physical-3"
        - "changes"
    cleanup:
      - incus network delete net-physical-3

  # ============================================================
  # CASE 4: network_004 - Macvlan minimal
  # ============================================================
  - name: network_004
    pillars:
      incus:
        networks:
          net-macvlan-4:
            network_type: macvlan
            description: Test macvlan network
            config:
              ipv4.address: none
              ipv6.address: none
              parent: eth0
              mtu: '1500'
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-macvlan-4"
        - "changes"
    cleanup:
      - incus network delete net-macvlan-4

  # ============================================================
  # CASE 5: network_005 - Macvlan full dual stack
  # ============================================================
  - name: network_005
    pillars:
      incus:
        networks:
          net-macvlan-5:
            network_type: macvlan
            description: Test macvlan network
            config:
              ipv4.address: 10.105.0.1/24
              ipv4.nat: 'true'
              ipv4.dhcp: 'true'
              ipv6.address: fd42:0005::1/64
              #ipv6.nat: 'true'
              ipv6.dhcp: 'true'
              dns.domain: test5.local
              dns.mode: managed
              parent: eth0
              mtu: '1500'
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-macvlan-5"
        - "changes"
    cleanup:
      - incus network delete net-macvlan-5

  # ============================================================
  # CASE 6: network_006 - Physical with IPv6 only
  # ============================================================
  - name: network_006
    pillars:
      incus:
        networks:
          net-physical-6:
            network_type: physical
            description: Test physical network
            config:
              ipv4.address: none
              ipv6.address: fd42:0006::1/64
              #ipv6.nat: 'true'
              ipv6.dhcp: 'true'
              dns.domain: test6.local
              dns.mode: managed
              parent: eth0
              mtu: '1500'
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-physical-6"
        - "changes"
    cleanup:
      - incus network delete net-physical-6

  # ============================================================
  # CASE 7: network_007 - OVN with IPv4 only
  # ============================================================
  - name: network_007
    pillars:
      incus:
        networks:
          net-ovn-7:
            network_type: ovn
            description: Test ovn network
            config:
              ipv4.address: 10.107.0.1/24
              ipv4.nat: 'true'
              ipv4.dhcp: 'true'
              ipv6.address: none
              network: ovn-uplink
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-ovn-7"
        - "changes"
    cleanup:
      - incus network delete net-ovn-7

  # ============================================================
  # CASE 8: network_008 - Bridge minimal no IP
  # ============================================================
  - name: network_008
    pillars:
      incus:
        networks:
          net-bridge-8:
            network_type: bridge
            description: Test bridge network
            config:
              ipv4.address: none
              ipv6.address: none
              dns.domain: test8.local
              dns.mode: managed
              bridge.driver: native
              bridge.mtu: '1500'
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-bridge-8"
        - "changes"
    cleanup:
      - incus network delete net-bridge-8

  # ============================================================
  # CASE 9: network_009 - Bridge with IPv6 only
  # ============================================================
  - name: network_009
    pillars:
      incus:
        networks:
          net-bridge-9:
            network_type: bridge
            description: Test bridge network
            config:
              ipv4.address: none
              ipv6.address: fd42:0009::1/64
              #ipv6.nat: 'true'
              ipv6.dhcp: 'true'
              bridge.driver: native
              bridge.mtu: '1500'
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-bridge-9"
        - "changes"
    cleanup:
      - incus network delete net-bridge-9

  # ============================================================
  # CASE 10: network_010 - Macvlan with IPv4 only
  # ============================================================
  - name: network_010
    pillars:
      incus:
        networks:
          net-macvlan-10:
            network_type: macvlan
            description: Test macvlan network
            config:
              ipv4.address: 10.110.0.1/24
              ipv4.nat: 'false'
              ipv4.dhcp: 'true'
              ipv6.address: none
              dns.domain: test10.local
              dns.mode: managed
              parent: eth0
              mtu: '1500'
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-macvlan-10"
        - "changes"
    cleanup:
      - incus network delete net-macvlan-10

  # ============================================================
  # CASE 11: network_011 - OVN dual stack full
  # ============================================================
  - name: network_011
    pillars:
      incus:
        networks:
          net-ovn-11:
            network_type: ovn
            description: Test ovn network
            config:
              ipv4.address: 10.111.0.1/24
              ipv4.nat: 'true'
              ipv4.dhcp: 'true'
              ipv6.address: fd42:000b::1/64
              #ipv6.nat: 'true'
              ipv6.dhcp: 'true'
              dns.domain: test11.local
              dns.mode: managed
              network: ovn-uplink
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-ovn-11"
        - "changes"
    cleanup:
      - incus network delete net-ovn-11

  # ============================================================
  # CASE 12: network_012 - Physical with IPv4 only
  # ============================================================
  - name: network_012
    pillars:
      incus:
        networks:
          net-physical-12:
            network_type: physical
            description: Test physical network
            config:
              ipv4.address: 10.112.0.1/24
              ipv4.nat: 'true'
              ipv4.dhcp: 'true'
              ipv6.address: none
              dns.domain: test12.local
              dns.mode: managed
              parent: eth0
              mtu: '1500'
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-physical-12"
        - "changes"
    cleanup:
      - incus network delete net-physical-12

  # ============================================================
  # CASE 13: network_013 - Physical minimal no IP
  # ============================================================
  - name: network_013
    pillars:
      incus:
        networks:
          net-physical-13:
            network_type: physical
            description: Test physical network
            config:
              ipv4.address: none
              ipv6.address: none
              dns.domain: test13.local
              dns.mode: managed
              parent: eth0
              mtu: '1500'
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-physical-13"
        - "changes"
    cleanup:
      - incus network delete net-physical-13

  # ============================================================
  # CASE 14: network_014 - OVN minimal no IP
  # ============================================================
  - name: network_014
    pillars:
      incus:
        networks:
          net-ovn-14:
            network_type: ovn
            description: Test ovn network
            config:
              ipv4.address: none
              ipv6.address: none
              dns.domain: test14.local
              dns.mode: managed
              network: ovn-uplink
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-ovn-14"
        - "changes"
    cleanup:
      - incus network delete net-ovn-14

  # ============================================================
  # CASE 15: network_015 - Macvlan with IPv6 only
  # ============================================================
  - name: network_015
    pillars:
      incus:
        networks:
          net-macvlan-15:
            network_type: macvlan
            description: Test macvlan network
            config:
              ipv4.address: none
              ipv6.address: fd42:000f::1/64
              #ipv6.nat: 'true'
              ipv6.dhcp: 'true'
              dns.domain: test15.local
              dns.mode: managed
              parent: eth0
              mtu: '1500'
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-macvlan-15"
        - "changes"
    cleanup:
      - incus network delete net-macvlan-15

  # ============================================================
  # CASE 16: network_016 - Bridge dual stack full
  # ============================================================
  - name: network_016
    pillars:
      incus:
        networks:
          net-bridge-16:
            network_type: bridge
            description: Test bridge network
            config:
              ipv4.address: 10.116.0.1/24
              ipv4.nat: 'true'
              ipv4.dhcp: 'true'
              ipv6.address: fd42:0010::1/64
              #ipv6.nat: 'true'
              ipv6.dhcp: 'true'
              dns.domain: test16.local
              dns.mode: managed
              bridge.driver: native
              bridge.mtu: '1500'
    command: state.apply networks
    expected:
      salt_output_contains:
        - "net-bridge-16"
        - "changes"
    cleanup:
      - incus network delete net-bridge-16
